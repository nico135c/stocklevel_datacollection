# Arduino Serial Data Logger

This is a simple Python tool for collecting measurement data from an Arduino over a serial
connection. For each part measured, the script reads 200 fresh samples and stores them as 
a new column in an Excel file (`.xlsx`). The first column contains the reading index (1–200),
and each subsequent column represents a new part.

# Ultrasound Sensor Data Visualizer

This Python tool processes measurement files generated by the data logger and produces a set of analytical plots. After selecting an Excel file (`.xlsx`) from the `data/` folder, the script loads all sensor readings, organizes them by part/stock level, and generates multiple visualizations—including mean-value trends, boxplots, scatter plots, a regression-based calibration curve, and a correlation heatmap. All plots are automatically saved to a dedicated output folder for easy review.

## Features
### Data Collection
- Automatically connects to an Arduino over serial
- Reads 200 fresh samples per part
- Saves the data into an Excel file (one column per part)

### Data Visualization
`visualizer.py` processes a selected `.xlsx` data file and generates several useful plots:
- Mean sensor reading vs. stock level
- Boxplots for all stock levels
- Scatter plot of all samples
- Linear regression calibration curve with confidence interval
- Correlation heatmap
- Saves all generated plots into a structured folder

## Requirements
### Data Collection
Install dependencies:
```
pip install pyserial
pip install openpyxl
```

### Data Visualization
Install dependencies:
```
pip install pandas
pip install numpy
pip install matplotlib
pip install seaborn
pip install scikit-learn
```

## Usage

### Data Collection

1. Connect your Arduino and ensure it prints numeric values over serial.
2. Update the serial port in `main.py` if needed (e.g., `/dev/ttyACM0`).
3. Update the excel filename in `main.py` if needed.
5. Run:
```
python3 main.py
```
6. Follow the prompts to collect data for each part.

### Data Visualization

1. Run the Data Collection script first, or ensure you have some data in the `data/` folder.
2. Run:
```
python3 visualizer.py
```
3. Follow the prompts to visualize the data.

## File Structure

- `main.py`  
  Controls data collection and Excel logging.

- `arduinoreader.py`  
  Minimal serial reader that returns fresh samples only.

- `visualizer.py`  
  Script that takes collected data and saves various plots.

## Output Format

### Data Collection

The generated Excel file has the following structure:

| Reading # | Part 1 | Part 2 | ... |
|-----------|--------|--------|-----|
| 1         | value  | value  | ... |
| 2         | value  | value  | ... |
| ...       | ...    | ...    | ... |
| 200       | value  | value  | ... |

Each part is stored in its own column.

### Data Visualization

Generates images of various plots saved as '.png' files.

---
